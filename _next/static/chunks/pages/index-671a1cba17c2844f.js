(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5405],{48312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(34579)}])},54779:function(e,n){"use strict";n.Z=[{inputs:[{internalType:"string",name:"question",type:"string"},{internalType:"string",name:"imgUrl",type:"string"}],name:"createPoll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getAllPollResults",outputs:[{components:[{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"yesCount",type:"uint256"},{internalType:"uint256",name:"noCount",type:"uint256"},{internalType:"string",name:"imgUrl",type:"string"}],internalType:"struct Voting.pollsListObj[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"pollIndex",type:"uint256"}],name:"getPollResults",outputs:[{internalType:"uint256",name:"yes",type:"uint256"},{internalType:"uint256",name:"no",type:"uint256"},{internalType:"uint256",name:"CurrentIndex",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPollsCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"polls",outputs:[{internalType:"string",name:"question",type:"string"},{internalType:"string",name:"imgUrl",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"pollIndex",type:"uint256"},{internalType:"bool",name:"choice",type:"bool"}],name:"vote",outputs:[],stateMutability:"nonpayable",type:"function"}]},34579:function(e,n,t){"use strict";t.r(n);var i=t(85893);t(67294);var s=t(25329),a=t(9008),l=t.n(a),r=t(59647),o=t.n(r),c=t(92321),u=t(3601),p=t(458);n.default=()=>{let{address:e,isConnected:n,status:t}=(0,c.m)(),{connector:a}=(0,c.m)();return(0,u.K)({address:e,unit:"ether"}),(0,i.jsxs)("div",{className:o().container,children:[(0,i.jsxs)(l(),{children:[(0,i.jsx)("title",{children:"VotingDApp"}),(0,i.jsx)("link",{href:"/favicon.ico",rel:"icon"})]}),(0,i.jsxs)("main",{className:o().main,children:[(0,i.jsx)("h1",{className:"font-bold text-4xl",children:"Voting-DApp"}),(0,i.jsx)("p",{className:"text-2xl mb-2",children:"欢迎使用Voting-DApp,一个基于Ethereum的去中心化投票系统"}),(0,i.jsx)("div",{className:"mb-3",children:(0,i.jsx)(s.NL,{label:n?"Connect Wallet":"请连接钱包并切换至sepolia...",accountStatus:"avatar"})}),n&&(0,i.jsx)(p.default,{})]})]})}},72697:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var i=t(85893),s=t(67294),a=t(41027),l=t(11993),r=t(38711),o=t(87740),c=t(86597),u=t(22311),p=t(96476),d=t(1300),m=t(54779);function x(e){let{open:n,setVoteFormOpen:t,dispatchContract:x,isPending:y,isConfirming:h,isConfirmed:f}=e,{isOpen:g,onOpen:j,onOpenChange:b,onClose:N}=(0,a.q)(),[_,v]=(0,s.useState)(""),[C,k]=(0,s.useState)("");return(0,s.useEffect)(()=>{n&&j(),f&&n&&t(!1),console.log(f,"isConfirmed")},[n,f]),(0,i.jsx)("div",{children:(0,i.jsx)(l.R,{backdrop:"opaque",isOpen:g,hideCloseButton:h||y,isDismissable:!1,onOpenChange:b,onClose:()=>{t(!1),N()},classNames:{backdrop:"bg-gradient-to-t from-zinc-900 to-zinc-900/10 backdrop-opacity-20"},children:(0,i.jsx)(r.A,{children:e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.k,{className:"flex flex-col gap-1",children:"创建投票"}),(0,i.jsxs)(c.I,{children:[(0,i.jsx)(u.Y,{type:"text",label:"投票名称",onValueChange:e=>{v(e)}}),(0,i.jsx)(u.Y,{type:"text",label:"投票图片链接",placeholder:"如果图片未加载出来说明地址防盗链,自动替换占位图",onValueChange:e=>{k(e)}})]}),(0,i.jsx)(p.R,{className:"justify-center",children:(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)(d.A,{isLoading:y||h,className:"w-unit-7xl mb-3",color:"primary",onPress:()=>{x({abi:m.Z,address:"0x0d77736F42EF631771550Ec616D202c4dc2A530B",functionName:"createPoll",args:[_,C]})},children:y||h?"交易确认中...":"确认创建"})})})]})})})})}},458:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return v}});var i=t(85893),s=t(67294),a=t(92321),l=t(82016),r=t(83540),o=t(89810),c=t(41027),u=t(1300),p=t(67898),d=t(24862),m=t(19314),x=t(46365),y=t(11993),h=t(38711),f=t(87740),g=t(86597),j=t(23658),b=t(96476),N=t(54779),_=t(72697);function v(){let{address:e,chain:n}=(0,a.m)(),{data:t,writeContract:v,isPending:C,error:k}=(0,l.S)(),{isLoading:E,isSuccess:T,isError:A}=(0,r.A)({hash:t}),{data:w,refetch:F,isFetching:P}=(0,o.u)({abi:N.Z,address:"0x0d77736F42EF631771550Ec616D202c4dc2A530B",functionName:"getAllPollResults"}),[S,D]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(k||T)&&(L(),F())},[k,T]);let O=async e=>{let{abi:n,address:t,functionName:i,args:s}=e;v({abi:n,address:t,functionName:i,args:s})},{isOpen:V,onOpen:L,onOpenChange:H}=(0,c.q)();return(0,i.jsx)("div",{className:"text-center",children:(null==n?void 0:n.name)==="Sepolia"?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{color:"primary",className:"w-unit-6xl mb-3",onClick:e=>{D(!0)},children:"创建新投票"}),null==w?void 0:w.map((e,n)=>(0,i.jsxs)(p.w,{className:"py-4 mb-3 w-unit-6xl",children:[(0,i.jsx)(d.u,{className:"pb-0 pt-2 px-4 flex-col items-start",children:(0,i.jsx)("h4",{className:"font-bold text-large",children:e.name})}),(0,i.jsx)(m.G,{className:"overflow-visible py-2",children:(0,i.jsx)(x.J,{alt:"Card background",isZoomed:!0,className:"object-cover rounded-xl",src:e.imgUrl,width:300,height:250,fallbackSrc:"https://via.placeholder.com/300x200"})}),(0,i.jsxs)("div",{className:"justify-center flex mb-1",children:[(0,i.jsxs)("span",{className:"mr-5",children:["赞成数:",(0,i.jsx)("span",{children:e.yesCount.toString()})]}),(0,i.jsxs)("span",{children:["反对数:",(0,i.jsx)("span",{children:e.noCount.toString()})]})]}),(0,i.jsxs)("div",{className:"justify-center flex",children:[(0,i.jsx)(u.A,{isLoading:C||E,size:"sm",color:"primary",className:"mr-5",onClick:()=>{O({abi:N.Z,address:"0x0d77736F42EF631771550Ec616D202c4dc2A530B",functionName:"vote",args:[n,!0]}),L()},children:C||E?"交易确认中...":"赞成"}),(0,i.jsx)(u.A,{size:"sm",color:"danger",onClick:()=>{O({abi:N.Z,address:"0x0d77736F42EF631771550Ec616D202c4dc2A530B",functionName:"vote",args:[n,!1]}),L()},children:C||E?"交易确认中...":"反对"})]})]},n)),(0,i.jsx)(y.R,{backdrop:"opaque",isOpen:V,hideCloseButton:E||C,isDismissable:!1,onOpenChange:H,classNames:{backdrop:"bg-gradient-to-t from-zinc-900 to-zinc-900/10 backdrop-opacity-20"},children:(0,i.jsx)(h.A,{children:e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.k,{className:"flex flex-col gap-1",children:"处理结果"}),(0,i.jsx)(g.I,{children:k?(0,i.jsx)("p",{children:k.shortMessage||k.message}):T?"交易已确认。":(0,i.jsx)(j.c,{label:"正在确认信息,请等待..."})}),(0,i.jsx)(b.R,{children:C||E?null:(0,i.jsx)(u.A,{color:"primary",onPress:e,isLoading:C||E,children:"确定"})})]})})}),(0,i.jsx)(_.default,{open:S,setVoteFormOpen:D,dispatchContract:O,isPending:C,isConfirming:E,isConfirmed:T})]}):(0,i.jsx)("div",{children:"当前项目仅支持sepolia,请切换至sepolia测试网"})})}},59647:function(e){e.exports={container:"Home_container__d256j",main:"Home_main__VkIEL",footer:"Home_footer__yFiaX",title:"Home_title__hYX6j",description:"Home_description__uXNdx",grid:"Home_grid__AVljO",card:"Home_card__E5spL"}},9008:function(e,n,t){e.exports=t(6665)}},function(e){e.O(0,[9629,1552,2888,9774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);